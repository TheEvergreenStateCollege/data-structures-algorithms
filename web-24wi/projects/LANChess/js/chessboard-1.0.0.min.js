/*! chessboard.js v1.0.0 | (c) 2019 Chris Oakman | MIT License chessboardjs.com/license */
!function(){"use strict";var e=window.jQuery,r="abcdefgh".split(""),n="1.8.3",t=w("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),a={};function o(e,r,n){var t=0,a=!1,o=[],i=function(){t=0,a&&(a=!1,s())},s=function(){t=window.setTimeout(i,r),e.apply(n,o)};return function(e){o=arguments,t?a=!0:s()}}function i(){return"xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){return(16*Math.random()|0).toString(16)})}function s(e){return JSON.parse(JSON.stringify(e))}function p(e){var r=e.split(".");return{major:parseInt(r[0],10),minor:parseInt(r[1],10),patch:parseInt(r[2],10)}}function c(e,r){for(var n in r)if(r.hasOwnProperty(n))for(var t="{"+n+"}",a=r[n];-1!==e.indexOf(t);)e=e.replace(t,a);return e}function u(e){return"string"==typeof e}function f(e){return"function"==typeof e}function d(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function h(e){return"fast"===e||"slow"===e||!!d(e)&&e>=0}function l(e){if(!u(e))return!1;var r=e.split("-");return 2===r.length&&_(r[0])&&_(r[1])}function _(e){return u(e)&&-1!==e.search(/^[a-h][1-8]$/)}function v(e){return u(e)&&-1!==e.search(/^[bw][KQRNBP]$/)}function g(e){if(!u(e))return!1;var r,n=(e=(r=e=e.replace(/ .+$/,""),r.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11"))).split("/");if(8!==n.length)return!1;for(var t=0;t<8;t++)if(8!==n[t].length||-1!==n[t].search(/[^kqrnbpKQRNBP1]/))return!1;return!0}function $(r){if(!e.isPlainObject(r))return!1;for(var n in r)if(r.hasOwnProperty(n)&&(!_(n)||!v(r[n])))return!1;return!0}function b(e){return e.toLowerCase()===e?"b"+e.toUpperCase():"w"+e.toUpperCase()}function m(e){var r=e.split("");return"w"===r[0]?r[1].toUpperCase():r[1].toLowerCase()}function w(e){if(!g(e))return!1;for(var n=(e=e.replace(/ .+$/,"")).split("/"),t={},a=8,o=0;o<8;o++){for(var i=n[o].split(""),s=0,p=0;p<i.length;p++)-1!==i[p].search(/[1-8]/)?s+=parseInt(i[p],10):(t[r[s]+a]=b(i[p]),s+=1);a-=1}return t}function P(e){if(!$(e))return!1;for(var n,t="",a=8,o=0;o<8;o++){for(var i=0;i<8;i++){var s=r[i]+a;e.hasOwnProperty(s)?t+=m(e[s]):t+="1"}7!==o&&(t+="/"),a-=1}return n=t,n.replace(/11111111/g,"8").replace(/1111111/g,"7").replace(/111111/g,"6").replace(/11111/g,"5").replace(/1111/g,"4").replace(/111/g,"3").replace(/11/g,"2")}function y(e,n){var t=e.split(""),a=r.indexOf(t[0])+1,o=parseInt(t[1],10),i=n.split(""),s=r.indexOf(i[0])+1,p=parseInt(i[1],10),c=Math.abs(a-s),u=Math.abs(o-p);return c>=u?c:u}function x(e,n,t){for(var a=function e(n){for(var t=[],a=0;a<8;a++)for(var o=0;o<8;o++){var i=r[a]+(o+1);n!==i&&t.push({square:i,distance:y(n,i)})}t.sort(function(e,r){return e.distance-r.distance});var s=[];for(a=0;a<t.length;a++)s.push(t[a].square);return s}(t),o=0;o<a.length;o++){var i=a[o];if(e.hasOwnProperty(i)&&e[i]===n)return i}return!1}a.alpha="alpha-d2270",a.black="black-3c85d",a.board="board-b72b1",a.chessboard="chessboard-63f37",a.clearfix="clearfix-7da63",a.highlight1="highlight1-32417",a.highlight2="highlight2-9c5d2",a.notation="notation-322f9",a.numeric="numeric-fc462",a.piece="piece-417db",a.row="row-5277c",a.sparePieces="spare-pieces-7492f",a.sparePiecesBottom="spare-pieces-bottom-ae20f",a.sparePiecesTop="spare-pieces-top-4028b",a.square="square-55d63",a.white="white-1e1d7",window.Chessboard=function v(b,m){if(window.$,(!e.fn||!e.fn.jquery||(T=e.fn.jquery,q=n,T=p(T),q=p(q),!((S=1e10*T.major+1e5*T.minor+T.patch)>=1e10*q.major+1e5*q.minor+q.patch)))&&(window.alert("Chessboard Error 1005: Unable to find a valid version of jQuery. Please include jQuery "+n+" or higher on the page\n\nExiting…"),1))return null;var y,O,T,q,S,E,k,C,B,j,D=function r(n){if(""===n)return window.alert("Chessboard Error 1001: The first argument to Chessboard() cannot be an empty string.\n\nExiting…"),!1;u(n)&&"#"!==n.charAt(0)&&(n="#"+n);var t=e(n);return 1!==t.length?(window.alert("Chessboard Error 1003: The first argument to Chessboard() must be the ID of a DOM node, an ID query selector, or a single DOM node.\n\nExiting…"),!1):t}(b);if(!D)return null;m=(y=m=("start"===(E=m)?E={position:s(t)}:g(E)?E={position:w(E)}:$(E)&&(E={position:s(E)}),e.isPlainObject(E)||(E={}),E),"black"!==y.orientation&&(y.orientation="white"),!1!==y.showNotation&&(y.showNotation=!0),!0!==y.draggable&&(y.draggable=!1),"trash"!==y.dropOffBoard&&(y.dropOffBoard="snapback"),!0!==y.sparePieces&&(y.sparePieces=!1),y.sparePieces&&(y.draggable=!0),y.hasOwnProperty("pieceTheme")&&(u(y.pieceTheme)||f(y.pieceTheme))||(y.pieceTheme="img/chesspieces/{piece}.png"),h(y.appearSpeed)||(y.appearSpeed=200),h(y.moveSpeed)||(y.moveSpeed=200),h(y.snapbackSpeed)||(y.snapbackSpeed=60),h(y.snapSpeed)||(y.snapSpeed=30),h(y.trashSpeed)||(y.trashSpeed=100),(!d(O=y.dragThrottleRate)||!(O>=1))&&(y.dragThrottleRate=20),y);var N=null,R=null,M=null,Q=null,X={},Y=2,I="white",K={},L=null,U=null,z=null,A=!1,F={},W={},G={},H=16;function J(e,r,n){if(!0===m.hasOwnProperty("showErrors")&&!1!==m.showErrors){var t="Chessboard Error "+e+": "+r;if("console"===m.showErrors&&"object"==typeof console&&"function"==typeof console.log){console.log(t),arguments.length>=2&&console.log(n);return}if("alert"===m.showErrors){n&&(t+="\n\n"+JSON.stringify(n)),window.alert(t);return}f(m.showErrors)&&m.showErrors(e,r,n)}}function V(e){return f(m.pieceTheme)?m.pieceTheme(e):u(m.pieceTheme)?c(m.pieceTheme,{piece:e}):(J(8272,"Unable to build image source for config.pieceTheme."),"")}function Z(e,r,n){var t='<img src="'+V(e)+'" ';return u(n)&&""!==n&&(t+='id="'+n+'" '),t+='alt="" class="{piece}" data-piece="'+e+'" style="width:'+H+"px;height:"+H+"px;",r&&(t+="display:none;"),c(t+='" />',a)}function ee(e){var r=["wK","wQ","wR","wB","wN","wP"];"black"===e&&(r=["bK","bQ","bR","bB","bN","bP"]);for(var n="",t=0;t<r.length;t++)n+=Z(r[t],!1,F[r[t]]);return n}function er(r,n,t,o){var s=e("#"+W[r]),p=s.offset(),c=e("#"+W[n]),u=c.offset(),d=i();e("body").append(Z(t,!0,d));var h=e("#"+d);h.css({display:"",position:"absolute",top:p.top,left:p.left}),s.find("."+a.piece).remove();var l={duration:m.moveSpeed,complete:function e(){c.append(Z(t)),h.remove(),f(o)&&o()}};h.animate(u,l)}function en(r,n,t){var o=e("#"+F[r]).offset(),s=e("#"+W[n]),p=s.offset(),c=i();e("body").append(Z(r,!0,c));var u=e("#"+c);u.css({display:"",position:"absolute",left:o.left,top:o.top});var d={duration:m.moveSpeed,complete:function e(){s.find("."+a.piece).remove(),s.append(Z(r)),u.remove(),f(t)&&t()}};u.animate(p,d)}function et(){for(var r in N.find("."+a.piece).remove(),K)K.hasOwnProperty(r)&&e("#"+W[r]).append(Z(K[r]))}function ea(){N.html(function e(n){"black"!==n&&(n="white");var t="",o=s(r),i=8;"black"===n&&(o.reverse(),i=1);for(var p="white",u=0;u<8;u++){t+='<div class="{row}">';for(var f=0;f<8;f++){var d=o[f]+i;t+='<div class="{square} '+a[p]+" square-"+d+'" style="width:'+H+"px;height:"+H+'px;" id="'+W[d]+'" data-square="'+d+'">',m.showNotation&&(("white"===n&&1===i||"black"===n&&8===i)&&(t+='<div class="{notation} {alpha}">'+o[f]+"</div>"),0===f&&(t+='<div class="{notation} {numeric}">'+i+"</div>")),t+="</div>",p="white"===p?"black":"white"}t+='<div class="{clearfix}"></div></div>',p="white"===p?"black":"white","white"===n?i-=1:i+=1}return c(t,a)}(I,H,m.showNotation)),et(),m.sparePieces&&("white"===I?(M.html(ee("black")),Q.html(ee("white"))):(M.html(ee("white")),Q.html(ee("black"))))}function eo(e){var r=s(K),n=s(e),t=P(r),a=P(n);t!==a&&(f(m.onChange)&&m.onChange(r,n),K=e)}function ei(e,r){for(var n in G)if(G.hasOwnProperty(n)){var t=G[n];if(e>=t.left&&e<t.left+H&&r>=t.top&&r<t.top+H)return n}return"offboard"}function es(){N.find("."+a.square).removeClass(a.highlight1+" "+a.highlight2)}function ep(){es();var e=s(K);delete e[z],eo(e),et(),R.fadeOut(m.trashSpeed),A=!1}function ec(r,n,t,o){(!f(m.onDragStart)||!1!==m.onDragStart(r,n,s(K),I))&&(A=!0,L=n,z=r,U="spare"===r?"offboard":r,function r(){for(var n in G={},W)W.hasOwnProperty(n)&&(G[n]=e("#"+W[n]).offset())}(),R.attr("src",V(n)).css({display:"",position:"absolute",left:t-H/2,top:o-H/2}),"spare"!==r&&e("#"+W[r]).addClass(a.highlight1).find("."+a.piece).css("display","none"))}function eu(r,n){R.css({left:r-H/2,top:n-H/2});var t=ei(r,n);t!==U&&(_(U)&&e("#"+W[U]).removeClass(a.highlight2),_(t)&&e("#"+W[t]).addClass(a.highlight2),f(m.onDragMove)&&m.onDragMove(t,U,z,L,s(K),I),U=t)}function ef(r){var n,t,a,o,i="drop";if("offboard"===r&&"snapback"===m.dropOffBoard&&(i="snapback"),"offboard"===r&&"trash"===m.dropOffBoard&&(i="trash"),f(m.onDrop)){var p=s(K);"spare"===z&&_(r)&&(p[r]=L),_(z)&&"offboard"===r&&delete p[z],_(z)&&_(r)&&(delete p[z],p[r]=L);var c=s(K),u=m.onDrop(z,r,L,p,c,I);("snapback"===u||"trash"===u)&&(i=u)}"snapback"===i?!function r(){if("spare"===z){ep();return}es();var n=e("#"+W[z]).offset(),t={duration:m.snapbackSpeed,complete:function e(){et(),R.css("display","none"),f(m.onSnapbackEnd)&&m.onSnapbackEnd(L,z,s(K),I)}};R.animate(n,t),A=!1}():"trash"===i?ep():"drop"===i&&(n=r,es(),delete(t=s(K))[z],t[n]=L,eo(t),a=e("#"+W[n]).offset(),o={duration:m.snapSpeed,complete:function e(){et(),R.css("display","none"),f(m.onSnapEnd)&&m.onSnapEnd(z,n,L)}},R.animate(a,o),A=!1)}X.clear=function(e){X.position({},e)},X.destroy=function(){D.html(""),R.remove(),D.unbind()},X.fen=function(){return X.position("fen")},X.flip=function(){return X.orientation("flip")},X.move=function(){if(0!==arguments.length){for(var e=!0,r={},n=0;n<arguments.length;n++){if(!1===arguments[n]){e=!1;continue}if(!l(arguments[n])){J(2826,"Invalid move passed to the move method.",arguments[n]);continue}var t=arguments[n].split("-");r[t[0]]=t[1]}var a=function e(r,n){var t=s(r);for(var a in n)if(n.hasOwnProperty(a)&&t.hasOwnProperty(a)){var o=t[a];delete t[a],t[n[a]]=o}return t}(K,r);return X.position(a,e),a}},X.orientation=function(e){return 0===arguments.length?I:"white"===e||"black"===e?(I=e,ea(),I):"flip"===e?(I="white"===I?"black":"white",ea(),I):void J(5482,"Invalid value passed to the orientation method.",e)},X.position=function(r,n){if(0===arguments.length)return s(K);if(u(r)&&"fen"===r.toLowerCase())return P(K);if(u(r)&&"start"===r.toLowerCase()&&(r=s(t)),g(r)&&(r=w(r)),!$(r)){J(6482,"Invalid value passed to the position method.",r);return}(!1!==n&&(n=!0),n)?(function r(n,t,o){if(0!==n.length)for(var i=0,p=0;p<n.length;p++){var c=n[p];"clear"===c.type?e("#"+W[c.square]+" ."+a.piece).fadeOut(m.trashSpeed,u):"add"!==c.type||m.sparePieces?"add"===c.type&&m.sparePieces?en(c.piece,c.square,u):"move"===c.type&&er(c.source,c.destination,c.piece,u):e("#"+W[c.square]).append(Z(c.piece,!0)).find("."+a.piece).fadeIn(m.appearSpeed,u)}function u(){(i+=1)===n.length&&(et(),f(m.onMoveEnd)&&m.onMoveEnd(s(t),s(o)))}}(function e(r,n){r=s(r),n=s(n);var t=[],a={};for(var o in n)n.hasOwnProperty(o)&&r.hasOwnProperty(o)&&r[o]===n[o]&&(delete r[o],delete n[o]);for(o in n)if(n.hasOwnProperty(o)){var i=x(r,n[o],o);i&&(t.push({type:"move",source:i,destination:o,piece:n[o]}),delete r[i],delete n[o],a[o]=!0)}for(o in n)n.hasOwnProperty(o)&&(t.push({type:"add",square:o,piece:n[o]}),delete n[o]);for(o in r)r.hasOwnProperty(o)&&(a.hasOwnProperty(o)||(t.push({type:"clear",square:o,piece:r[o]}),delete r[o]));return t}(K,r),K,r),eo(r)):(eo(r),et())},X.resize=function(){H=function e(){var r=parseInt(D.width(),10);if(!r||r<=0)return 0;for(var n=r-1;n%8!=0&&n>0;)n-=1;return n/8}(),N.css("width",8*H+"px"),R.css({height:H,width:H}),m.sparePieces&&D.find("."+a.sparePieces).css("paddingLeft",H+Y+"px"),ea()},X.start=function(e){X.position("start",e)};var ed=o(function e(r){A&&eu(r.pageX,r.pageY)},m.dragThrottleRate),eh=o(function e(r){A&&(r.preventDefault(),eu(r.originalEvent.changedTouches[0].pageX,r.originalEvent.changedTouches[0].pageY))},m.dragThrottleRate);return I=m.orientation,m.hasOwnProperty("position")&&("start"===m.position?K=s(t):g(m.position)?K=w(m.position):$(m.position)?K=s(m.position):J(7263,"Invalid value passed to config.position.",m.position)),function e(){for(var n=0;n<r.length;n++)for(var t=1;t<=8;t++){var a=r[n]+t;W[a]=a+"-"+i()}var o="KQRNBP".split("");for(n=0;n<o.length;n++){var s="w"+o[n],p="b"+o[n];F[s]=s+"-"+i(),F[p]=p+"-"+i()}}(),D.html((k=m.sparePieces,C='<div class="{chessboard}">',k&&(C+='<div class="{sparePieces} {sparePiecesTop}"></div>'),C+='<div class="{board}"></div>',k&&(C+='<div class="{sparePieces} {sparePiecesBottom}"></div>'),c(C+="</div>",a))),N=D.find("."+a.board),m.sparePieces&&(M=D.find("."+a.sparePiecesTop),Q=D.find("."+a.sparePiecesBottom)),B=i(),e("body").append(Z("wP",!0,B)),R=e("#"+B),Y=parseInt(N.css("borderLeftWidth"),10),X.resize(),e("body").on("mousedown mousemove","."+a.piece,function e(r){r.preventDefault()}),N.on("mousedown","."+a.square,function r(n){if(m.draggable){var t=e(this).attr("data-square");_(t)&&K.hasOwnProperty(t)&&ec(t,K[t],n.pageX,n.pageY)}}),D.on("mousedown","."+a.sparePieces+" ."+a.piece,function r(n){m.sparePieces&&ec("spare",e(this).attr("data-piece"),n.pageX,n.pageY)}),N.on("mouseenter","."+a.square,function r(n){if(!A&&f(m.onMouseoverSquare)){var t=e(n.currentTarget).attr("data-square");if(_(t)){var a=!1;K.hasOwnProperty(t)&&(a=K[t]),m.onMouseoverSquare(t,a,s(K),I)}}}).on("mouseleave","."+a.square,function r(n){if(!A&&f(m.onMouseoutSquare)){var t=e(n.currentTarget).attr("data-square");if(_(t)){var a=!1;K.hasOwnProperty(t)&&(a=K[t]),m.onMouseoutSquare(t,a,s(K),I)}}}),(j=e(window)).on("mousemove",ed).on("mouseup",function e(r){A&&ef(ei(r.pageX,r.pageY))}),"ontouchstart"in document.documentElement&&(N.on("touchstart","."+a.square,function r(n){if(m.draggable){var t=e(this).attr("data-square");_(t)&&K.hasOwnProperty(t)&&(n=n.originalEvent,ec(t,K[t],n.changedTouches[0].pageX,n.changedTouches[0].pageY))}}),D.on("touchstart","."+a.sparePieces+" ."+a.piece,function r(n){if(m.sparePieces){var t;ec("spare",e(this).attr("data-piece"),(n=n.originalEvent).changedTouches[0].pageX,n.changedTouches[0].pageY)}}),j.on("touchmove",eh).on("touchend",function e(r){A&&ef(ei(r.originalEvent.changedTouches[0].pageX,r.originalEvent.changedTouches[0].pageY))})),X},window.ChessBoard=window.Chessboard,window.Chessboard.fenToObj=w,window.Chessboard.objToFen=P}();